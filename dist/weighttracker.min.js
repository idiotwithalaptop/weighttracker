/*! weighttracker 12-10-2014 */
function AzureWeightService(){tableSvc.createTableIfNotExists("weight",function(a){})}function WeighIn(a,b){date=b,result=a}var express=require("express"),path=require("path"),favicon=require("serve-favicon"),logger=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),routes=require("./routes/index"),users=require("./routes/users"),weighIns=require("./routes/api/weighIn"),app=express();app.set("views",path.join(__dirname,"views")),app.set("view engine","ejs"),app.use(logger("dev")),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!1})),app.use(cookieParser()),app.use(express.static(path.join(__dirname,"public"))),app.use("/",routes),app.use("/users",users),app.user("/api/weighIns",weighIns),app.use(function(a,b,c){var d=new Error("Not Found");d.status=404,c(d)}),"development"===app.get("env")&&app.use(function(a,b,c){c.status(a.status||500),c.render("error",{message:a.message,error:a})}),app.use(function(a,b,c){c.status(a.status||500),c.render("error",{message:a.message,error:{}})}),module.exports=app;var azure=require("azure-storage");require("../../domain/weighin");var tableSvc=azure.createTableService(),exports=module.exports;AzureWeightService.prototype.insertWeighIn=function(a,b){var c=azure.TableUtilities.entityGenerator,d={PartitionKey:c.String(a),RowKey:c.String(b.date),result:c.Double(weignin.result),date:c.DateTime(b.date)};tableSvc.insertEntity("weight",d,function(a){})},AzureWeightService.prototype.getWeighInsForUser=function(a){var b=(new azure.TableQuery).where("PartitionKey eq ?",a),c=[];return tableSvc.queryEntities("weight",b,null,function(a,b){if(!a)for(var d=0;d<b.entries.length;d++){var e=b.entries[d],f=new WeighIn(e.result,e.date);c.push(f)}}),c},exports.createWeighInService=function(){return new AzureWeightService};var date,result;WeighIn.prototype={date:date,result:result};var express=require("express"),router=express.Router(),data=require("../../data/azure/weight").createWeighInService();require("../../domain/weighin"),router.get("/",function(a,b){b.json({message:"no direct services available"})}),router.get("/:userId",function(a,b){b.json(data.getWeighInsForUser(a.params.userId))}),router.put("/:userId",function(a,b){var c=new WeighIn(a.body.result,a.body.date);data.insertWeighIn(a.params.userId,c),b.json({message:"Weigh-In Captured"})}),module.exports=router;var express=require("express"),router=express.Router();router.get("/",function(a,b){b.render("index",{title:"Express"})}),module.exports=router;var express=require("express"),router=express.Router();router.get("/",function(a,b){b.send("respond with a resource")}),module.exports=router;